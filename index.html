<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Roleta de Pr√™mios</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #8A2BE2;
      --secondary: #FF69B4;
      --dark: #4B0082;
      --light: #F8F8FF;
      --accent: #FFD700;
      --text: #333333;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #8A2BE2 0%, #4B0082 100%);
      color: var(--light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      text-align: center;
    }
    
    .container {
      max-width: 800px;
      width: 100%;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      margin-top: 20px;
    }
    
    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      background: linear-gradient(to right, var(--accent), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .subtitle {
      font-size: 1.1rem;
      margin-bottom: 30px;
      opacity: 0.9;
    }
    
    .input-group {
      margin: 20px 0;
    }
    
    #nick {
      width: 300px;
      padding: 15px 20px;
      border: none;
      border-radius: 50px;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      outline: none;
    }
    
    #nick:focus {
      transform: scale(1.03);
      box-shadow: 0 0 0 3px var(--accent);
    }
    
    button {
      background: linear-gradient(to right, var(--secondary), var(--primary));
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 18px;
      font-weight: 600;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      margin: 20px 0;
    }
    
    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 7px 20px rgba(0, 0, 0, 0.3);
    }
    
    button:active {
      transform: translateY(1px);
    }
    
    .wheel-container {
      position: relative;
      width: 400px;
      height: 400px;
      margin: 0 auto;
    }
    
    #roleta {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      box-shadow: 0 0 0 10px rgba(255, 255, 255, 0.1),
                  0 0 20px rgba(0, 0, 0, 0.3),
                  inset 0 0 20px rgba(0, 0, 0, 0.2);
      transition: transform 0.5s ease-out;
    }
    
    .pointer {
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 25px solid transparent;
      border-right: 25px solid transparent;
      border-top: 40px solid var(--accent);
      filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
      z-index: 10;
    }
    
    .pointer::after {
      content: '';
      position: absolute;
      top: -50px;
      left: -15px;
      width: 30px;
      height: 30px;
      background: var(--accent);
      border-radius: 50%;
      box-shadow: 0 0 10px var(--accent);
    }
    
    .stand {
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 20px;
      height: 50px;
      background: linear-gradient(to bottom, #c0c0c0, #808080);
      border-radius: 0 0 5px 5px;
    }
    
    .stand::before, .stand::after {
      content: '';
      position: absolute;
      bottom: 0;
      width: 80px;
      height: 10px;
      background: linear-gradient(to bottom, #c0c0c0, #808080);
      border-radius: 5px;
    }
    
    .stand::before {
      left: -100px;
      transform: rotate(25deg);
    }
    
    .stand::after {
      right: -100px;
      transform: rotate(-25deg);
    }
    
    #resultado {
      font-size: 1.5rem;
      font-weight: bold;
      margin: 30px 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: all 0.5s ease;
      min-height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      background-color: var(--accent);
      opacity: 0;
      pointer-events: none;
      z-index: 1000;
    }
    
    @keyframes fall {
      0% {
        opacity: 1;
        transform: translateY(0) rotate(0deg);
      }
      100% {
        opacity: 0;
        transform: translateY(100vh) rotate(360deg);
      }
    }
    
    .winner-flash {
      animation: winnerFlash 1s infinite alternate;
    }
    
    @keyframes winnerFlash {
      from {
        background: rgba(255, 215, 0, 0.2);
        box-shadow: 0 0 20px var(--accent);
        transform: scale(1);
      }
      to {
        background: rgba(255, 215, 0, 0.4);
        box-shadow: 0 0 40px var(--accent);
        transform: scale(1.05);
      }
    }
    
    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .wheel-container {
        width: 300px;
        height: 300px;
      }
      
      #nick {
        width: 90%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üé° Roleta de Pr√™mios</h1>
    <p class="subtitle">Gire a roleta e teste sua sorte para ganhar pr√™mios incr√≠veis!</p>
    
    <div class="input-group">
      <input id="nick" placeholder="Digite seu nick">
    </div>
    
    <button onclick="girar()">Girar Roleta!</button>
    
    <div class="wheel-container">
      <div class="pointer"></div>
      <div class="stand"></div>
      <canvas id="roleta" width="400" height="400"></canvas>
    </div>
    
    <p id="resultado"></p>
  </div>

  <!-- Sons (pode trocar os URLs se quiser outros efeitos) -->
  <audio id="somTick" src="https://actions.google.com/sounds/v1/impacts/wood_plank_flicks.ogg" preload="auto"></audio>
  <audio id="somVitoria" src="https://actions.google.com/sounds/v1/crowds/cheer.ogg" preload="auto"></audio>

  <script>
    // === SUA API DO GOOGLE APPS SCRIPT ===
    const API_URL = "https://script.google.com/macros/s/AKfycbz_qOsdx0avjQZ0Hg6ktnTeYknYAb3x-nmdnHvwVZ0K0KVZSk6QSxuQkMoi2KdPX8wNuQ/exec";

    // === CONFIGURA√á√ÉO DOS PR√äMIOS ===
    // Deixe os "chances" reais aqui. Visualmente, as fatias s√£o sempre iguais.
    const premios = [
      { nome: "1 foto nua",  chance: 10, cor: "#FF6B6B" },
      { nome: "3 fotinhos nuas", chance: 10, cor: "#4ECDC4" },
      { nome: "1 v√≠deo chamada",    chance: 0, cor: "#FFD166" },
      { nome: "2 fotinhos semis", chance: 10, cor: "#06D6A0" },
      { nome: "5 fotinhos dos p√©s", chance: 10, cor: "#118AB2" },
      { nome: "1 v√≠deo personalizado 5 minutos", chance: 0, cor: "#073B4C" },
      { nome: "escolha qualquer pack", chance: 7, cor: "#F72585" },
      { nome: "avalia√ß√£o", chance: 7, cor: "#7209B7" },
      { nome: "sexting 30 minutos", chance: 0, cor: "#3A0CA3" },
      { nome: "plaquinha", chance: 1, cor: "#4361EE" },
      { nome: "1 video de masturba√ß√£o", chance: 7, cor: "#4CC9F0" },
      { nome: "videozinho anal", chance: 7, cor: "#FB5607" },
      { nome: "√°udio de provoca√ß√£o", chance: 7, cor: "#FF006E" },
      { nome: "2 packs pelo pre√ßo de 1", chance: 10, cor: "#8338EC" },
      { nome: "50% de desconto em servi√ßo", chance: 7, cor: "#3A86FF" },
      { nome: "50% de desconto em pack", chance: 7, cor: "#FF9E00" },
    ];

    const canvas = document.getElementById("roleta");
    const ctx = canvas.getContext("2d");
    const radius = canvas.width / 2;

    const somTick = document.getElementById("somTick");
    const somVitoria = document.getElementById("somVitoria");

    let fatiaAng = (2 * Math.PI) / premios.length;
    let setores = [];       // { premio, inicio, fim }
    let girando = false;

    // Desenha a roleta (fatias iguais)
    function desenharRoleta() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      setores = [];

      let inicio = 0;
      for (const p of premios) {
        const fim = inicio + fatiaAng;

        // fatia
        ctx.beginPath();
        ctx.moveTo(radius, radius);
        ctx.arc(radius, radius, radius, inicio, fim);
        ctx.fillStyle = p.cor;
        ctx.fill();

        // borda da fatia
        ctx.lineWidth = 2;
        ctx.strokeStyle = "white";
        ctx.stroke();

        // texto
        ctx.save();
        ctx.translate(radius, radius);
        ctx.rotate(inicio + fatiaAng / 2);
        ctx.textAlign = "right";
        ctx.fillStyle = "#FFF";
        ctx.font = "bold 12px Poppins";
        ctx.fillText(p.nome, radius - 15, 5);
        ctx.restore();

        setores.push({ premio: p.nome, inicio, fim });
        inicio = fim;
      }

      // Centro da roleta
      ctx.beginPath();
      ctx.arc(radius, radius, 20, 0, 2 * Math.PI);
      ctx.fillStyle = "var(--accent)";
      ctx.fill();
      ctx.strokeStyle = "white";
      ctx.lineWidth = 3;
      ctx.stroke();
    }

    desenharRoleta(); // desenho inicial sem rota√ß√£o

    // Sorteio REAL baseado nas chances
    function sortearPremio() {
      const total = premios.reduce((s, p) => s + p.chance, 0);
      let r = Math.random() * total;
      let acumulado = 0;
      for (const p of premios) {
        acumulado += p.chance;
        if (r <= acumulado) return p.nome;
      }
    }

    // Normaliza um √¢ngulo para [0, 2œÄ)
    function normalizarAng(a) {
      const doisPi = 2 * Math.PI;
      a = a % doisPi;
      if (a < 0) a += doisPi;
      return a;
    }

    // Criar efeito de confete
    function criarConfete() {
      const colors = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#00FFFF'];
      for (let i = 0; i < 100; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + 'vw';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.width = Math.random() * 10 + 5 + 'px';
        confetti.style.height = Math.random() * 10 + 5 + 'px';
        confetti.style.animation = `fall ${Math.random() * 3 + 2}s linear forwards`;
        document.body.appendChild(confetti);
        
        // Remover ap√≥s anima√ß√£o
        setTimeout(() => {
          confetti.remove();
        }, 5000);
      }
    }

    // Anima√ß√£o de giro (fixo: 10s) e alinhamento no topo (seta)
    function girar() {
      if (girando) return;
      const nick = document.getElementById("nick").value.trim();
      if (!nick) { alert("Digite seu nick!"); return; }

      girando = true;

      // Pr√™mio sorteado (probabilidade real)
      const premio = sortearPremio();

      // Centro angular da fatia do pr√™mio
      const alvo = setores.find(s => s.premio === premio);
      const meio = (alvo.inicio + alvo.fim) / 2;

      // Queremos que "meio" chegue ao topo (3œÄ/2 rad)
      const offsetTopo = normalizarAng(3 * Math.PI / 2 - meio);

      // V√°rias voltas + offset at√© a seta
      const voltas = 10 * 2 * Math.PI;   // 10 voltas completas
      const anguloFinal = voltas + offsetTopo;

      // Anima√ß√£o (10s com ease out c√∫bico)
      const inicio = performance.now();
      const duracao = 10000;
      let passosTick = -1; // para tocar o "tic" quando cruzar bordas

      function frame(t) {
        const progresso = Math.min(1, (t - inicio) / duracao);
        const easeOut = 1 - Math.pow(1 - progresso, 3);
        const anguloAtual = anguloFinal * easeOut;

        // desenha roleta j√° rotacionada
        ctx.save();
        ctx.translate(radius, radius);
        ctx.rotate(anguloAtual); // rota√ß√£o positiva = sentido hor√°rio
        ctx.translate(-radius, -radius);
        desenharRoleta();
        ctx.restore();

        // toca "tic" a cada borda de fatia que passa sob a seta
        const passoAtual = Math.floor(anguloAtual / fatiaAng);
        if (passoAtual !== passosTick) {
          try { somTick.currentTime = 0; somTick.play(); } catch (e) {}
          passosTick = passoAtual;
        }

        if (progresso < 1) {
          requestAnimationFrame(frame);
        } else {
          girando = false;

          // resultado final
          const resultadoEl = document.getElementById("resultado");
          resultadoEl.innerHTML = `<span>${nick} ganhou: ${premio}</span>`;
          resultadoEl.classList.add('winner-flash');
          
          // som de comemora√ß√£o
          try { somVitoria.currentTime = 0; somVitoria.play(); } catch (e) {}
          
          // efeito de confete
          criarConfete();

          // envia para planilha
          fetch(API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: new URLSearchParams({ nick, premio }).toString()
          });
        }
      }

      requestAnimationFrame(frame);
    }
  </script>
</body>
</html>
